/*
 * This file is part of Saenaru.
 *
 * Copyright (c) 1990-1998 Microsoft Corporation.
 * Copyright (c) 2006 Hye-Shik Chang <perky@i18n.org>.
 * Copyright (c) 2006 Won-Kyu Park <wkpark@kldp.org>.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 * $Saenaru: saenaru/src/hanjaidx.c,v 1.3 2006/11/22 15:32:34 wkpark Exp $
 */

#include <windows.h>
#include <immdev.h>
#include "saenaru.h"
#include "immsec.h"

#define IDX_COL	32
#define UNIHAN_UNI 20902
#define UNIHAN_EXTA 6582
#define UNIHAN_COMP 301
#define CRLF 4

UINT ksx1002_table[]={
0x4E1F, 0x4E26, 0x4E2B, 0x4E30, 0x4E31, 0x4E67, 0x4E6C, 0x4E7C, 0x4E8F, 0x4E99,
0x4E9F, 0x4EB3, 0x4EB4, 0x4EB9, 0x4EC6, 0x4EDE, 0x4EE1, 0x4EEE, 0x4EF3, 0x4EF5,
0x4EFF, 0x4F00, 0x4F30, 0x4F42, 0x4F49, 0x4F4B, 0x4F53, 0x4F54, 0x4F56, 0x4F57,
0x4F5D, 0x4F5E, 0x4F5F, 0x4F6A, 0x4F78, 0x4F79, 0x4F7B, 0x4F7C, 0x4F7D, 0x4F89,
0x4F94, 0x4F97, 0x4F9A, 0x4F9C, 0x4FB2, 0x4FBB, 0x4FC1, 0x4FC5, 0x4FCC, 0x4FCF,
0x4FD0, 0x4FD8, 0x4FDB, 0x4FE3, 0x4FF0, 0x4FF4, 0x4FF6, 0x4FFE, 0x5000, 0x5005,
0x500F, 0x5014, 0x5018, 0x5022, 0x5025, 0x5029, 0x502E, 0x5030, 0x5044, 0x504A,
0x504E, 0x5053, 0x5056, 0x5058, 0x5060, 0x5062, 0x506A, 0x5070, 0x5072, 0x508B,
0x5092, 0x5094, 0x5096, 0x509A, 0x509B, 0x509D, 0x509E, 0x50A2, 0x50AE, 0x50B4,
0x50BD, 0x50BF, 0x50C2, 0x50C4, 0x50DB, 0x50E2, 0x50E6, 0x50E9, 0x50EC, 0x50EE,
0x50F5, 0x50FE, 0x5102, 0x5103, 0x5107, 0x510B, 0x5110, 0x5113, 0x5114, 0x5115,
0x5117, 0x5118, 0x511A, 0x511B, 0x511C, 0x5122, 0x5124, 0x5125, 0x5127, 0x512B,
0x5131, 0x5133, 0x5135, 0x5139, 0x513B, 0x5155, 0x5157, 0x515A, 0x5189, 0x518F,
0x5193, 0x5198, 0x51A3, 0x51A4, 0x51B0, 0x51B1, 0x51B2, 0x51C5, 0x51CA, 0x51D2,
0x51D4, 0x51DB, 0x51E0, 0x51E9, 0x51ED, 0x51F3, 0x51F4, 0x5201, 0x5213, 0x5216,
0x5226, 0x5227, 0x5231, 0x5232, 0x5233, 0x5244, 0x5249, 0x5255, 0x5257, 0x525A,
0x525E, 0x525F, 0x5274, 0x5277, 0x527A, 0x5282, 0x5293, 0x5297, 0x5298, 0x52AC,
0x52AD, 0x52CC, 0x52E0, 0x52E1, 0x52E6, 0x5301, 0x5302, 0x5303, 0x530A, 0x530C,
0x5327, 0x5331, 0x5336, 0x533D, 0x533E, 0x5345, 0x5361, 0x536C, 0x536E, 0x5372,
0x5373, 0x5378, 0x5379, 0x537A, 0x537B, 0x537E, 0x5396, 0x539D, 0x53AA, 0x53AE,
0x53B2, 0x53B9, 0x53C5, 0x53DF, 0x53E6, 0x53E8, 0x53EE, 0x53F4, 0x53F5, 0x53F6,
0x5401, 0x540B, 0x542C, 0x542E, 0x5436, 0x543D, 0x5440, 0x5446, 0x544E, 0x545D, 
0x5462, 0x5464, 0x5466, 0x546B, 0x5470, 0x5476, 0x547F, 0x5484, 0x5487, 0x548B, 
0x548D, 0x548F, 0x5496, 0x54A0, 0x54A2, 0x54A5, 0x54AF, 0x54BB, 0x54BC, 0x54BF, 
0x54C2, 0x54C3, 0x54C6, 0x54C7, 0x54E6, 0x54E9, 0x54F1, 0x54FD, 0x54FF, 0x5509, 
0x550F, 0x5514, 0x552B, 0x552E, 0x5533, 0x553C, 0x5540, 0x5542, 0x5557, 0x555C, 
0x557B, 0x557D, 0x557E, 0x5581, 0x5583, 0x558B, 0x5591, 0x5593, 0x5594, 0x559E, 
0x559F, 0x55A3, 0x55A4, 0x55A8, 0x55B0, 0x55C9, 0x55D1, 0x55DB, 0x55E0, 0x55E2, 
0x55F7, 0x55FF, 0x5604, 0x5608, 0x560C, 0x560D, 0x560E, 0x5610, 0x5612, 0x5616, 
0x5629, 0x562C, 0x5637, 0x5638, 0x5639, 0x563B, 0x563F, 0x5641, 0x5642, 0x5649, 
0x564B, 0x564D, 0x564E, 0x564F, 0x5664, 0x5665, 0x5669, 0x566A, 0x566C, 0x566D, 
0x566F, 0x5672, 0x5676, 0x5678, 0x567A, 0x5680, 0x5684, 0x5687, 0x568F, 0x5699, 
0x569A, 0x56B3, 0x56B6, 0x56C0, 0x56C1, 0x56C2, 0x56C3, 0x56C8, 0x56C9, 0x56DF, 
0x56E6, 0x56EB, 0x56EE, 0x56F7, 0x56FF, 0x5701, 0x5702, 0x5709, 0x570A, 0x571C, 
0x5725, 0x572C, 0x572E, 0x573E, 0x574C, 0x574F, 0x5767, 0x5768, 0x5769, 0x576F, 
0x5771, 0x5773, 0x5777, 0x5778, 0x577B, 0x578C, 0x5795, 0x579E, 0x57A4, 0x57B8, 
0x57BD, 0x57C6, 0x57C9, 0x57CF, 0x57D1, 0x57D2, 0x57DC, 0x57E4, 0x57ED, 0x57F3, 
0x57FB, 0x57FD, 0x5803, 0x580B, 0x5817, 0x5819, 0x581D, 0x5820, 0x5823, 0x5826, 
0x5840, 0x5849, 0x584C, 0x584D, 0x5850, 0x5852, 0x5859, 0x5869, 0x587D, 0x5880, 
0x5881, 0x588A, 0x588D, 0x5890, 0x589D, 0x58A1, 0x58A3, 0x58AB, 0x58B0, 0x58B1, 
0x58C3, 0x58D4, 0x58DA, 0x58DC, 0x58DD, 0x5906, 0x5908, 0x5910, 0x5924, 0x5925, 
0x592C, 0x592F, 0x5938, 0x5953, 0x5958, 0x5969, 0x5976, 0x5991, 0x5992, 0x599D, 
0x59A3, 0x59A7, 0x59AF, 0x59B2, 0x59C8, 0x59CD, 0x59D2, 0x59DE, 0x59E3, 0x59E4, 
0x59E5, 0x59FA, 0x5A09, 0x5A13, 0x5A19, 0x5A23, 0x5A27, 0x5A2D, 0x5A35, 0x5A3F, 
0x5A40, 0x5A4C, 0x5A50, 0x5A63, 0x5A67, 0x5A6A, 0x5A72, 0x5A77, 0x5A7F, 0x5A84, 
0x5A8D, 0x5A93, 0x5A95, 0x5A9F, 0x5AA2, 0x5AA7, 0x5AAA, 0x5AB3, 0x5AB5, 0x5ABA, 
0x5ABB, 0x5ABC, 0x5ABD, 0x5ABE, 0x5ABF, 0x5AC8, 0x5ACB, 0x5AD6, 0x5AD7, 0x5AD9, 
0x5ADA, 0x5ADB, 0x5AE0, 0x5AE2, 0x5AE3, 0x5AE5, 0x5AEB, 0x5AED, 0x5AEE, 0x5AEF, 
0x5AF6, 0x5AFA, 0x5AFB, 0x5AFD, 0x5B00, 0x5B08, 0x5B19, 0x5B1B, 0x5B25, 0x5B28, 
0x5B2D, 0x5B30, 0x5B32, 0x5B34, 0x5B3E, 0x5B3F, 0x5B45, 0x5B4C, 0x5B56, 0x5B5B, 
0x5B61, 0x5B65, 0x5B76, 0x5B7F, 0x5B81, 0x5B82, 0x5B8A, 0x5BD6, 0x5BD8, 0x5BED, 
0x5BF0, 0x5C05, 0x5C0C, 0x5C14, 0x5C1F, 0x5C20, 0x5C2B, 0x5C41, 0x5C47, 0x5C50, 
0x5C68, 0x5C73, 0x5C7A, 0x5C88, 0x5C8A, 0x5C8C, 0x5C8F, 0x5C92, 0x5C94, 0x5C9D, 
0x5CA3, 0x5CA5, 0x5CA6, 0x5CA7, 0x5CA8, 0x5CAA, 0x5CAD, 0x5CD2, 0x5CE9, 0x5CED, 
0x5CF1, 0x5D06, 0x5D10, 0x5D15, 0x5D1B, 0x5D1F, 0x5D22, 0x5D24, 0x5D26, 0x5D34, 
0x5D3D, 0x5D41, 0x5D42, 0x5D4E, 0x5D53, 0x5D54, 0x5D71, 0x5D81, 0x5D82, 0x5D84, 
0x5D92, 0x5D94, 0x5D95, 0x5D99, 0x5DA7, 0x5DAB, 0x5DAE, 0x5DB0, 0x5DB7, 0x5DC9, 
0x5DCB, 0x5DD1, 0x5DD3, 0x5DDA, 0x5DF5, 0x5DF9, 0x5E09, 0x5E15, 0x5E1A, 0x5E28, 
0x5E37, 0x5E43, 0x5E4E, 0x5E54, 0x5E58, 0x5E5E, 0x5E68, 0x5E6A, 0x5E6B, 0x5E6C, 
0x5E70, 0x5E71, 0x5E7A, 0x5E7F, 0x5E8B, 0x5E96, 0x5EB3, 0x5EBD, 0x5EC1, 0x5ECB, 
0x5ED1, 0x5ED5, 0x5EDD, 0x5EDE, 0x5EE1, 0x5EE5, 0x5EE7, 0x5EE8, 0x5EE9, 0x5EF1, 
0x5EFF, 0x5F03, 0x5F07, 0x5F08, 0x5F0B, 0x5F22, 0x5F25, 0x5F2D, 0x5F34, 0x5F40, 
0x5F46, 0x5F54, 0x5F58, 0x5F5D, 0x5F64, 0x5F82, 0x5F88, 0x5F89, 0x5F9C, 0x5FA3, 
0x5FA7, 0x5FAC, 0x5FAD, 0x5FAF, 0x5FBC, 0x5FC9, 0x5FD0, 0x5FD2, 0x5FDD, 0x5FDE, 
0x5FDF, 0x5FE1, 0x5FE4, 0x5FE8, 0x5FED, 0x5FEE, 0x5FF1, 0x5FF8, 0x5FFB, 0x5FFC, 
0x600A, 0x600D, 0x6014, 0x6015, 0x6017, 0x6019, 0x601B, 0x6026, 0x6029, 0x6033, 
0x6046, 0x6047, 0x6048, 0x604A, 0x605A, 0x605F, 0x6060, 0x606B, 0x6081, 0x6083, 
0x6084, 0x608B, 0x608F, 0x6092, 0x6095, 0x6097, 0x60A2, 0x60B1, 0x60B5, 0x60BB, 
0x60BE, 0x60C4, 0x60C6, 0x60C9, 0x60CB, 0x60CF, 0x60D3, 0x60D5, 0x60D8, 0x60D9, 
0x60DB, 0x60DD, 0x60E2, 0x60F2, 0x60F4, 0x60F7, 0x60F8, 0x60FC, 0x6100, 0x6103, 
0x6114, 0x611C, 0x612C, 0x612D, 0x6146, 0x614D, 0x6152, 0x615A, 0x6160, 0x6171, 
0x6173, 0x6174, 0x6175, 0x617A, 0x6183, 0x618D, 0x6192, 0x6196, 0x61A8, 0x61AF, 
0x61B8, 0x61BB, 0x61BC, 0x61C6, 0x61CC, 0x61D5, 0x61D7, 0x61DE, 0x61DF, 0x61E3, 
0x61FD, 0x61FE, 0x6214, 0x6215, 0x621E, 0x6222, 0x6227, 0x6229, 0x6232, 0x6233, 
0x6235, 0x6239, 0x6243, 0x624A, 0x624E, 0x6251, 0x6252, 0x6257, 0x625B, 0x6263, 
0x6268, 0x6273, 0x627A, 0x627E, 0x6283, 0x6286, 0x6294, 0x6296, 0x62A8, 0x62AC, 
0x62C4, 0x62C5, 0x62C6, 0x62CA, 0x62D1, 0x62D5, 0x62F5, 0x62F6, 0x62FD, 0x6302, 
0x630C, 0x6310, 0x6312, 0x6328, 0x632A, 0x6339, 0x6342, 0x6343, 0x6344, 0x6346, 
0x634D, 0x634E, 0x6357, 0x6369, 0x636B, 0x6371, 0x6376, 0x6380, 0x6384, 0x6387, 
0x638A, 0x638E, 0x638F, 0x639C, 0x639F, 0x63AC, 0x63BE, 0x63C3, 0x63C9, 0x63DF, 
0x63E0, 0x63E3, 0x63E9, 0x63EB, 0x63F2, 0x63F5, 0x6406, 0x6409, 0x6412, 0x6424, 
0x6425, 0x6428, 0x642A, 0x642B, 0x642F, 0x6430, 0x6436, 0x6467, 0x646D, 0x6473, 
0x647B, 0x647D, 0x6485, 0x6490, 0x6495, 0x6499, 0x649D, 0x649F, 0x64A9, 0x64BC, 
0x64BE, 0x64BF, 0x64C9, 0x64D0, 0x64D5, 0x64D7, 0x64E0, 0x64E3, 0x64ED, 0x64EF, 
0x64F1, 0x6502, 0x6507, 0x650A, 0x650F, 0x6514, 0x6519, 0x6522, 0x6524, 0x6532, 
0x653D, 0x6549, 0x6554, 0x6555, 0x655D, 0x6581, 0x659D, 0x65B1, 0x65B2, 0x65BF, 
0x65C2, 0x65C3, 0x65C4, 0x65C6, 0x65CA, 0x65F2, 0x6600, 0x6603, 0x661B, 0x6621, 
0x6624, 0x662B, 0x6635, 0x6637, 0x6648, 0x664C, 0x664E, 0x6661, 0x6662, 0x666C, 
0x6670, 0x667B, 0x668B, 0x668C, 0x669E, 0x66A3, 0x66AC, 0x66B1, 0x66B5, 0x66B8, 
0x66BF, 0x66C0, 0x66C1, 0x66C5, 0x66D3, 0x66DA, 0x66DB, 0x66E3, 0x66E8, 0x66E9, 
0x66EA, 0x66EC, 0x66EE, 0x66EF, 0x6705, 0x670C, 0x6723, 0x6733, 0x6745, 0x6760, 
0x676A, 0x676C, 0x6772, 0x677C, 0x678C, 0x6798, 0x6799, 0x67B2, 0x67C1, 0x67C5, 
0x67CA, 0x67D7, 0x67D8, 0x67D9, 0x67DE, 0x67DF, 0x67E2, 0x67F9, 0x6803, 0x681D, 
0x681E, 0x682E, 0x6831, 0x6832, 0x6834, 0x683B, 0x6844, 0x6846, 0x6849, 0x686F, 
0x6874, 0x6877, 0x687E, 0x6883, 0x6886, 0x689B, 0x68A0, 0x68A3, 0x68CA, 0x68CC, 
0x68D0, 0x68D6, 0x68E3, 0x68EC, 0x68FB, 0x68FC, 0x6901, 0x6904, 0x690B, 0x6911, 
0x6919, 0x6934, 0x6936, 0x6939, 0x6942, 0x694F, 0x695D, 0x6965, 0x696A, 0x696C, 
0x6973, 0x698E, 0x6991, 0x6994, 0x6998, 0x699F, 0x69A4, 0x69A6, 0x69AD, 0x69B0, 
0x69B1, 0x69B7, 0x69BC, 0x69BE, 0x69C0, 0x69C7, 0x69CA, 0x69CE, 0x69D3, 0x69E5, 
0x69E6, 0x69E7, 0x69E9, 0x69ED, 0x69F2, 0x69F9, 0x6A00, 0x6A05, 0x6A0B, 0x6A12, 
0x6A14, 0x6A1B, 0x6A2B, 0x6A3B, 0x6A43, 0x6A47, 0x6A4A, 0x6A50, 0x6A5A, 0x6A62, 
0x6A66, 0x6A75, 0x6A7F, 0x6A90, 0x6A94, 0x6A9D, 0x6A9F, 0x6AA0, 0x6AAE, 0x6AB6, 
0x6ABC, 0x6ABF, 0x6ADC, 0x6ADD, 0x6ADE, 0x6ADF, 0x6AEA, 0x6AEC, 0x6AFC, 0x6B02, 
0x6B03, 0x6B11, 0x6B1E, 0x6B2C, 0x6B37, 0x6B38, 0x6B39, 0x6B3B, 0x6B3F, 0x6B43, 
0x6B49, 0x6B54, 0x6B59, 0x6B5A, 0x6B5B, 0x6B60, 0x6B67, 0x6B80, 0x6B82, 0x6B8D, 
0x6B91, 0x6BA2, 0x6BA4, 0x6BAB, 0x6BAD, 0x6BB3, 0x6BBD, 0x6BC4, 0x6BDA, 0x6BEF, 
0x6BF3, 0x6BFF, 0x6C05, 0x6C10, 0x6C1B, 0x6C24, 0x6C33, 0x6C3F, 0x6C43, 0x6C4B, 
0x6C4F, 0x6C52, 0x6C54, 0x6C59, 0x6C5B, 0x6C5C, 0x6C74, 0x6C84, 0x6C89, 0x6C8D, 
0x6C98, 0x6CAC, 0x6CB0, 0x6CB1, 0x6CC5, 0x6CC6, 0x6CD0, 0x6CD1, 0x6CD4, 0x6CD9, 
0x6CDA, 0x6CDC, 0x6CDD, 0x6CE0, 0x6CF1, 0x6D04, 0x6D07, 0x6D0A, 0x6D12, 0x6D1F, 
0x6D2B, 0x6D2C, 0x6D2E, 0x6D3A, 0x6D3C, 0x6D61, 0x6D64, 0x6D65, 0x6D67, 0x6D82, 
0x6D94, 0x6D96, 0x6DAA, 0x6DAB, 0x6DB4, 0x6DB7, 0x6DB8, 0x6DBC, 0x6DBF, 0x6DC8, 
0x6DD2, 0x6DD6, 0x6DDD, 0x6DE0, 0x6DE2, 0x6DE4, 0x6DE5, 0x6DE6, 0x6DEC, 0x6DF6, 
0x6DFC, 0x6E1D, 0x6E28, 0x6E37, 0x6E45, 0x6E4E, 0x6E51, 0x6E53, 0x6E54, 0x6E63, 
0x6E8F, 0x6E95, 0x6E98, 0x6EA7, 0x6EB2, 0x6EB5, 0x6EB7, 0x6EBD, 0x6EC3, 0x6EC8, 
0x6ED5, 0x6ED9, 0x6EEC, 0x6EED, 0x6EF5, 0x6EF7, 0x6F04, 0x6F09, 0x6F0C, 0x6F13, 
0x6F19, 0x6F1A, 0x6F2A, 0x6F2D, 0x6F30, 0x6F33, 0x6F3C, 0x6F3E, 0x6F4F, 0x6F59, 
0x6F5C, 0x6F5D, 0x6F61, 0x6F66, 0x6F6F, 0x6F74, 0x6F78, 0x6F82, 0x6F86, 0x6F89, 
0x6F8B, 0x6F8C, 0x6F92, 0x6F98, 0x6F9F, 0x6FA1, 0x6FA8, 0x6FB6, 0x6FC6, 0x6FC7, 
0x6FC9, 0x6FD8, 0x6FDB, 0x6FDE, 0x6FEE, 0x6FF3, 0x6FF4, 0x6FFA, 0x7007, 0x7012, 
0x7013, 0x7026, 0x7030, 0x7032, 0x7038, 0x703C, 0x7044, 0x704E, 0x7053, 0x705E, 
0x7069, 0x706F, 0x707E, 0x7081, 0x7086, 0x7095, 0x70AE, 0x70B0, 0x70CA, 0x70D3, 
0x70DC, 0x711C, 0x7120, 0x712D, 0x712E, 0x712F, 0x7131, 0x7146, 0x7152, 0x7157, 
0x7162, 0x7168, 0x7180, 0x7185, 0x7187, 0x719B, 0x71A0, 0x71A4, 0x71A8, 0x71AF, 
0x71B2, 0x71CB, 0x71D6, 0x71D9, 0x71E0, 0x71EC, 0x71F9, 0x7207, 0x720B, 0x720C, 
0x720D, 0x7214, 0x7217, 0x721A, 0x721F, 0x7225, 0x7228, 0x7238, 0x7239, 0x7242, 
0x724B, 0x7253, 0x7254, 0x7256, 0x725A, 0x726F, 0x7274, 0x7278, 0x7287, 0x728D, 
0x7292, 0x7296, 0x72B3, 0x72B4, 0x72B5, 0x72C9, 0x72D2, 0x72E2, 0x72E5, 0x72E8, 
0x72F4, 0x72F7, 0x72FA, 0x72FB, 0x7309, 0x7313, 0x7317, 0x7318, 0x7319, 0x7322, 
0x7327, 0x7328, 0x7331, 0x7334, 0x7343, 0x7358, 0x735C, 0x7360, 0x7369, 0x736B, 
0x736C, 0x736F, 0x7377, 0x737C, 0x7381, 0x7388, 0x7395, 0x739E, 0x73A0, 0x73A6, 
0x73AB, 0x73B7, 0x73BB, 0x73C6, 0x73C8, 0x73D2, 0x73E2, 0x73EB, 0x73EE, 0x73F5, 
0x7404, 0x7424, 0x7431, 0x7432, 0x7445, 0x7446, 0x744E, 0x745D, 0x7463, 0x746D, 
0x7470, 0x7471, 0x7472, 0x7473, 0x747D, 0x7480, 0x7486, 0x748A, 0x749D, 0x74AB, 
0x74DB, 0x74E9, 0x74F2, 0x7503, 0x750C, 0x750D, 0x750E, 0x7513, 0x751E, 0x753F, 
0x754A, 0x754B, 0x754E, 0x755A, 0x7560, 0x7564, 0x7567, 0x756B, 0x7588, 0x7594, 
0x7599, 0x759A, 0x75A3, 0x75A9, 0x75B4, 0x75C0, 0x75C3, 0x75CA, 0x75CE, 0x75D3, 
0x75DE, 0x75E3, 0x75E4, 0x75E7, 0x75F3, 0x75F9, 0x75FF, 0x7601, 0x7607, 0x7608, 
0x7609, 0x760B, 0x7610, 0x7615, 0x7627, 0x762F, 0x7630, 0x7633, 0x7634, 0x7643, 
0x7646, 0x7648, 0x7649, 0x7655, 0x7658, 0x765C, 0x7662, 0x7665, 0x7667, 0x7668, 
0x766D, 0x766E, 0x766F, 0x7671, 0x7680, 0x7681, 0x7683, 0x768B, 0x7696, 0x769A, 
0x769B, 0x769C, 0x769E, 0x76A4, 0x76AC, 0x76B4, 0x76B6, 0x76B8, 0x76CC, 0x76CD, 
0x76CE, 0x76D4, 0x76D9, 0x76E5, 0x76EA, 0x76EC, 0x76F1, 0x76F9, 0x76FB, 0x7707, 
0x770A, 0x770C, 0x771A, 0x771B, 0x7725, 0x7726, 0x7728, 0x7734, 0x773B, 0x773E, 
0x7746, 0x7747, 0x7752, 0x775A, 0x775F, 0x7760, 0x7762, 0x7765, 0x7768, 0x7777, 
0x777D, 0x778D, 0x778E, 0x7796, 0x7799, 0x77A0, 0x77A2, 0x77AA, 0x77B9, 0x77BD, 
0x77C7, 0x77C9, 0x77CD, 0x77D9, 0x77DA, 0x77DE, 0x77E1, 0x77E7, 0x77F0, 0x77FA, 
0x77FB, 0x77FC, 0x77FD, 0x780C, 0x780F, 0x7811, 0x7822, 0x782D, 0x7830, 0x7843, 
0x785C, 0x7860, 0x7867, 0x7868, 0x786E, 0x788F, 0x7893, 0x789F, 0x78A4, 0x78A8, 
0x78AD, 0x78BE, 0x78C8, 0x78CF, 0x78D1, 0x78D4, 0x78D5, 0x78DA, 0x78E0, 0x78E7, 
0x78EA, 0x78F4, 0x78F7, 0x78FA, 0x78FC, 0x78FD, 0x790C, 0x790F, 0x7911, 0x7912, 
0x7919, 0x7927, 0x792D, 0x7931, 0x7945, 0x7946, 0x794A, 0x7953, 0x7954, 0x7955, 
0x795F, 0x7962, 0x7967, 0x797C, 0x7980, 0x798A, 0x798B, 0x7994, 0x799D, 0x79A8, 
0x79AB, 0x79B0, 0x79B4, 0x79BA, 0x79BB, 0x79C6, 0x79E2, 0x79E3, 0x79EA, 0x79EB, 
0x79EC, 0x79F8, 0x7A01, 0x7A02, 0x7A0A, 0x7A0C, 0x7A1E, 0x7A27, 0x7A39, 0x7A45, 
0x7A60, 0x7A75, 0x7A7E, 0x7A80, 0x7A82, 0x7A83, 0x7A85, 0x7A86, 0x7A8A, 0x7A96, 
0x7A97, 0x7A9B, 0x7AA0, 0x7AA3, 0x7AAC, 0x7AB3, 0x7AB6, 0x7AB9, 0x7ABB, 0x7ABE, 
0x7ABF, 0x7AC8, 0x7AE2, 0x7AE6, 0x7AF8, 0x7AFD, 0x7B06, 0x7B08, 0x7B0A, 0x7B0C, 
0x7B12, 0x7B18, 0x7B25, 0x7B27, 0x7B28, 0x7B2F, 0x7B33, 0x7B35, 0x7B45, 0x7B48, 
0x7B53, 0x7B5F, 0x7B65, 0x7B66, 0x7B67, 0x7B69, 0x7B71, 0x7B73, 0x7B8D, 0x7B8E, 
0x7B92, 0x7B99, 0x7B9C, 0x7BA0, 0x7BBE, 0x7BCA, 0x7BCB, 0x7BCC, 0x7BD4, 0x7BD9, 
0x7BDB, 0x7BDD, 0x7BE6, 0x7BEA, 0x7BF3, 0x7BF7, 0x7BFE, 0x7C00, 0x7C09, 0x7C0B, 
0x7C0F, 0x7C1F, 0x7C20, 0x7C37, 0x7C38, 0x7C50, 0x7C52, 0x7C54, 0x7C5B, 0x7C5C, 
0x7C5F, 0x7C65, 0x7C67, 0x7C69, 0x7C72, 0x7C7E, 0x7C81, 0x7C8D, 0x7CA2, 0x7CA4, 
0x7CA6, 0x7CA8, 0x7CBC, 0x7CBD, 0x7CC5, 0x7CC6, 0x7CD5, 0x7CD7, 0x7CD9, 0x7CDA, 
0x7CDC, 0x7CDD, 0x7CE2, 0x7CE5, 0x7CEF, 0x7CF2, 0x7CF4, 0x7CF6, 0x7CF8, 0x7CFA, 
0x7D03, 0x7D13, 0x7D15, 0x7D1C, 0x7D31, 0x7D32, 0x7D49, 0x7D4D, 0x7D56, 0x7D59, 
0x7D5B, 0x7D5C, 0x7D63, 0x7D69, 0x7D70, 0x7D7A, 0x7D83, 0x7D86, 0x7D98, 0x7DA3, 
0x7DA5, 0x7DA6, 0x7DA7, 0x7DA9, 0x7DAB, 0x7DAE, 0x7DB0, 0x7DC4, 0x7DCC, 0x7DCD, 
0x7DD7, 0x7DDC, 0x7DE6, 0x7DF6, 0x7DF9, 0x7E08, 0x7E0B, 0x7E10, 0x7E11, 0x7E17, 
0x7E18, 0x7E20, 0x7E22, 0x7E32, 0x7E33, 0x7E35, 0x7E39, 0x7E3B, 0x7E44, 0x7E45, 
0x7E48, 0x7E50, 0x7E56, 0x7E57, 0x7E59, 0x7E5A, 0x7E62, 0x7E6F, 0x7E76, 0x7E7D, 
0x7E7E, 0x7E81, 0x7E87, 0x7E88, 0x7E8A, 0x7E8D, 0x7E94, 0x7F37, 0x7F3E, 0x7F3F, 
0x7F43, 0x7F44, 0x7F45, 0x7F47, 0x7F4B, 0x7F4D, 0x7F4E, 0x7F58, 0x7F5D, 0x7F5F, 
0x7F60, 0x7F61, 0x7F63, 0x7F66, 0x7F68, 0x7F78, 0x7F7C, 0x7F7D, 0x7F7E, 0x7F82, 
0x7F86, 0x7F87, 0x7F96, 0x7F97, 0x7F98, 0x7F9D, 0x7FAB, 0x7FAF, 0x7FB6, 0x7FD6, 
0x7FDB, 0x7FE3, 0x7FE4, 0x7FE6, 0x7FEC, 0x7FEE, 0x7FF3, 0x7FFA, 0x7FFB, 0x7FFE, 
0x8004, 0x8011, 0x8012, 0x8014, 0x8016, 0x8019, 0x801E, 0x8021, 0x8026, 0x8028, 
0x802C, 0x8030, 0x8052, 0x8055, 0x8071, 0x8075, 0x8076, 0x8093, 0x8098, 0x809A, 
0x80A6, 0x80AB, 0x80AD, 0x80B5, 0x80C6, 0x80CA, 0x80D5, 0x80D6, 0x80D9, 0x80E0, 
0x80EF, 0x80F7, 0x80FE, 0x8109, 0x8116, 0x8124, 0x8127, 0x8130, 0x813A, 0x8141, 
0x8146, 0x814A, 0x8152, 0x8153, 0x8160, 0x8164, 0x816D, 0x8174, 0x8176, 0x8177, 
0x8182, 0x8183, 0x8184, 0x8186, 0x818B, 0x819E, 0x81A9, 0x81B0, 0x81B4, 0x81B8, 
0x81B9, 0x81CA, 0x81CF, 0x81D1, 0x81D9, 0x81DA, 0x81DD, 0x81E0, 0x81EC, 0x81F6, 
0x8201, 0x8202, 0x8203, 0x8210, 0x8216, 0x8233, 0x8238, 0x823D, 0x8251, 0x8258, 
0x825A, 0x825F, 0x8268, 0x826A, 0x826B, 0x8274, 0x828A, 0x8294, 0x8298, 0x82A1, 
0x82A2, 0x82A3, 0x82A7, 0x82A8, 0x82AA, 0x82AB, 0x82B0, 0x82BE, 0x82C5, 0x82D3, 
0x82DC, 0x82E0, 0x82E3, 0x82EB, 0x82F3, 0x82F4, 0x82F9, 0x82FA, 0x82FB, 0x82FF, 
0x8300, 0x8308, 0x831B, 0x831C, 0x831D, 0x8323, 0x832A, 0x8332, 0x8333, 0x833C, 
0x8343, 0x8350, 0x8385, 0x8392, 0x8393, 0x839A, 0x839B, 0x839D, 0x839F, 0x83A0, 
0x83A8, 0x83BE, 0x83BF, 0x83C2, 0x83D1, 0x83D4, 0x83D8, 0x83DF, 0x83E0, 0x83E1, 
0x83F6, 0x8406, 0x8407, 0x840B, 0x8435, 0x8439, 0x843C, 0x8446, 0x844A, 0x8451, 
0x845A, 0x8469, 0x846A, 0x846D, 0x8471, 0x8473, 0x8477, 0x8482, 0x849F, 0x84A8, 
0x84AD, 0x84AF, 0x84B4, 0x84B9, 0x84BA, 0x84C1, 0x84CA, 0x84D0, 0x84D3, 0x84D6, 
0x84ED, 0x84EF, 0x84F1, 0x84FD, 0x8500, 0x8506, 0x8515, 0x851F, 0x8526, 0x852A, 
0x8546, 0x854A, 0x854B, 0x8555, 0x8556, 0x8558, 0x855E, 0x8561, 0x8564, 0x856B, 
0x857A, 0x857E, 0x8580, 0x8586, 0x8589, 0x858A, 0x858C, 0x8597, 0x8599, 0x859D, 
0x85A4, 0x85A5, 0x85D0, 0x85F9, 0x85FD, 0x8600, 0x8604, 0x860B, 0x8618, 0x8622, 
0x8627, 0x8629, 0x862F, 0x863C, 0x8641, 0x8653, 0x866B, 0x866C, 0x866F, 0x8671, 
0x8678, 0x867A, 0x867B, 0x868B, 0x868D, 0x8695, 0x86A8, 0x86AA, 0x86AF, 0x86B0, 
0x86B1, 0x86B4, 0x86C0, 0x86C5, 0x86C6, 0x86C9, 0x86DE, 0x86E3, 0x86E9, 0x86EC, 
0x86F8, 0x86F9, 0x86FB, 0x8706, 0x8709, 0x870A, 0x870B, 0x8711, 0x871D, 0x8721, 
0x8725, 0x8728, 0x8729, 0x8734, 0x8735, 0x8737, 0x873A, 0x873B, 0x873F, 0x8740, 
0x874C, 0x8759, 0x8760, 0x8764, 0x8765, 0x876E, 0x8783, 0x878C, 0x8798, 0x879E, 
0x87A3, 0x87AD, 0x87B4, 0x87BB, 0x87BD, 0x87C0, 0x87C7, 0x87CA, 0x87CB, 0x87D2, 
0x87DA, 0x87DB, 0x87E3, 0x87F7, 0x880D, 0x8811, 0x8815, 0x8821, 0x8832, 0x8839, 
0x8844, 0x884A, 0x884E, 0x885E, 0x886E, 0x887D, 0x889B, 0x889D, 0x88A2, 0x88AA, 
0x88C0, 0x88C5, 0x88CA, 0x88CD, 0x88D2, 0x88D8, 0x88EF, 0x88F1, 0x88F9, 0x88FE, 
0x8904, 0x890A, 0x890C, 0x8915, 0x891A, 0x8927, 0x892B, 0x8930, 0x893A, 0x894D, 
0x8956, 0x8958, 0x895C, 0x895E, 0x8960, 0x896D, 0x896F, 0x8974, 0x8988, 0x8989, 
0x8997, 0x8998, 0x89A8, 0x89AC, 0x89AF, 0x89B7, 0x89BF, 0x89D4, 0x89D6, 0x89DA, 
0x89DC, 0x89DD, 0x89E5, 0x89F1, 0x89F3, 0x8A07, 0x8A09, 0x8A10, 0x8A11, 0x8A14, 
0x8A15, 0x8A22, 0x8A3C, 0x8A3E, 0x8A41, 0x8A46, 0x8A4B, 0x8A51, 0x8A56, 0x8A57, 
0x8A58, 0x8A61, 0x8A6B, 0x8A6C, 0x8A7C, 0x8A7F, 0x8A82, 0x8A84, 0x8A86, 0x8A91, 
0x8A9A, 0x8AA2, 0x8AA7, 0x8AC9, 0x8ADE, 0x8ADF, 0x8AE0, 0x8AE4, 0x8AF0, 0x8AF3, 
0x8AF4, 0x8AFC, 0x8B07, 0x8B0C, 0x8B11, 0x8B1C, 0x8B23, 0x8B26, 0x8B37, 0x8B3E, 
0x8B43, 0x8B4C, 0x8B54, 0x8B56, 0x8B59, 0x8B5F, 0x8B6B, 0x8B71, 0x8B7F, 0x8B89, 
0x8B8C, 0x8B8E, 0x8B9C, 0x8B9E, 0x8C47, 0x8C49, 0x8C4E, 0x8C56, 0x8C62, 0x8C68, 
0x8C6C, 0x8C73, 0x8C78, 0x8C83, 0x8C8D, 0x8C93, 0x8C94, 0x8C98, 0x8CB2, 0x8CBA, 
0x8CC6, 0x8CD9, 0x8CE1, 0x8CEC, 0x8D0B, 0x8D0F, 0x8D10, 0x8D14, 0x8D1B, 0x8D67, 
0x8D6D, 0x8D76, 0x8D81, 0x8D8E, 0x8D90, 0x8DA0, 0x8DAB, 0x8DB2, 0x8DC2, 0x8DCE, 
0x8DD5, 0x8DD6, 0x8DD7, 0x8DDF, 0x8DEA, 0x8DEB, 0x8DEC, 0x8DF1, 0x8DFC, 0x8E06, 
0x8E08, 0x8E09, 0x8E14, 0x8E1D, 0x8E1F, 0x8E34, 0x8E36, 0x8E3D, 0x8E40, 0x8E4C, 
0x8E4F, 0x8E55, 0x8E5C, 0x8E63, 0x8E64, 0x8E72, 0x8E7B, 0x8E85, 0x8E89, 0x8E8B, 
0x8E90, 0x8E91, 0x8E93, 0x8E94, 0x8E99, 0x8EA1, 0x8EA9, 0x8EB1, 0x8EB3, 0x8EC6, 
0x8EE8, 0x8EF9, 0x8EFA, 0x8EFC, 0x8F07, 0x8F08, 0x8F28, 0x8F30, 0x8F40, 0x8F42, 
0x8F46, 0x8F52, 0x8F54, 0x8F57, 0x8F58, 0x8F5E, 0x8F61, 0x8F63, 0x8F64, 0x8F9F, 
0x8FA2, 0x8FAE, 0x8FBB, 0x8FBF, 0x8FC0, 0x8FC3, 0x8FC4, 0x8FCD, 0x8FD3, 0x8FD5, 
0x8FE2, 0x8FE4, 0x8FE5, 0x8FE8, 0x8FEC, 0x8FF4, 0x8FF8, 0x8FFA, 0x900C, 0x9016, 
0x9034, 0x9036, 0x9049, 0x904F, 0x9052, 0x9058, 0x905B, 0x9068, 0x906C, 0x9076, 
0x9085, 0x908C, 0x9090, 0x90A0, 0x90B3, 0x90BD, 0x90C3, 0x90C4, 0x90C5, 0x90DC, 
0x90DD, 0x90E2, 0x90EA, 0x90EB, 0x90EF, 0x90F4, 0x911E, 0x9122, 0x9123, 0x9130, 
0x9131, 0x9134, 0x913D, 0x9148, 0x9156, 0x9157, 0x9163, 0x9164, 0x9165, 0x9172, 
0x9174, 0x9176, 0x9179, 0x9183, 0x9190, 0x919E, 0x91A2, 0x91AA, 0x91B2, 0x91C1, 
0x91C3, 0x91C5, 0x91E4, 0x91E6, 0x91ED, 0x91FF, 0x9207, 0x9214, 0x921C, 0x921F, 
0x9235, 0x9237, 0x9238, 0x9241, 0x924B, 0x924E, 0x924F, 0x9250, 0x9252, 0x9277, 
0x9278, 0x927C, 0x927E, 0x928B, 0x9295, 0x9299, 0x929A, 0x929B, 0x92C6, 0x92D1, 
0x92D7, 0x92DF, 0x92E5, 0x92F2, 0x92F9, 0x92FA, 0x92FD, 0x9306, 0x930F, 0x9315, 
0x9319, 0x9323, 0x9327, 0x932A, 0x932C, 0x9349, 0x9357, 0x935C, 0x935D, 0x9364, 
0x936B, 0x936C, 0x9370, 0x938A, 0x9397, 0x939B, 0x939F, 0x93A1, 0x93A4, 0x93C7, 
0x93C8, 0x93CA, 0x93CB, 0x93CC, 0x93D6, 0x93D7, 0x93D8, 0x93DC, 0x93DD, 0x93DF, 
0x93E2, 0x93E6, 0x93E8, 0x93FB, 0x9403, 0x940F, 0x9410, 0x9413, 0x9414, 0x9419, 
0x942A, 0x9436, 0x943A, 0x9442, 0x944A, 0x944C, 0x9455, 0x945E, 0x9460, 0x9462, 
0x9463, 0x946A, 0x9470, 0x9471, 0x9472, 0x9475, 0x9477, 0x947C, 0x947E, 0x9588, 
0x958A, 0x958E, 0x959F, 0x95A9, 0x95AB, 0x95AC, 0x95B6, 0x95B9, 0x95BD, 0x95BE, 
0x95C3, 0x95C8, 0x95CB, 0x95CC, 0x95CD, 0x95D3, 0x95DA, 0x95DE, 0x95E0, 0x95E5, 
0x9624, 0x9628, 0x962F, 0x9658, 0x9661, 0x966C, 0x9672, 0x9674, 0x967C, 0x9684, 
0x9691, 0x9697, 0x96A4, 0x96A9, 0x96B0, 0x96B3, 0x96B4, 0x96B6, 0x96B8, 0x96B9, 
0x96BC, 0x96DA, 0x96DD, 0x96DE, 0x96FA, 0x9704, 0x9705, 0x9708, 0x9709, 0x970C, 
0x970D, 0x970E, 0x970F, 0x9714, 0x9723, 0x9726, 0x972A, 0x9738, 0x9746, 0x9749, 
0x974C, 0x975A, 0x975B, 0x975D, 0x9760, 0x9766, 0x9768, 0x9773, 0x9775, 0x977C, 
0x9780, 0x9781, 0x9784, 0x9785, 0x9798, 0x97A3, 0x97A6, 0x97AC, 0x97B1, 0x97B4, 
0x97B8, 0x97B9, 0x97C1, 0x97C3, 0x97CD, 0x97D0, 0x97D9, 0x97DD, 0x97DE, 0x97E0, 
0x97E1, 0x97ED, 0x97EE, 0x97F1, 0x97F2, 0x97F5, 0x97FA, 0x980D, 0x980E, 0x980F, 
0x9816, 0x981E, 0x9821, 0x9823, 0x9826, 0x982B, 0x982E, 0x9837, 0x983F, 0x9842, 
0x9847, 0x9848, 0x984B, 0x9852, 0x9853, 0x9859, 0x9866, 0x9870, 0x9871, 0x9873, 
0x9874, 0x98AD, 0x98B2, 0x98B6, 0x98BA, 0x98BC, 0x98BF, 0x98C2, 0x98C9, 0x98CB, 
0x98E6, 0x98E7, 0x98EA, 0x98EB, 0x98F1, 0x98FB, 0x9912, 0x9914, 0x9915, 0x991A, 
0x9926, 0x9927, 0x992A, 0x992C, 0x992E, 0x9930, 0x9931, 0x9933, 0x9939, 0x993C, 
0x993D, 0x9942, 0x9948, 0x9950, 0x9955, 0x995C, 0x995E, 0x9997, 0x9998, 0x99A3, 
0x99B0, 0x99C4, 0x99C8, 0x99C9, 0x99CF, 0x99D8, 0x99DB, 0x99DC, 0x99DE, 0x99E2, 
0x99E8, 0x99EA, 0x99EE, 0x99F8, 0x99FB, 0x99FD, 0x9A02, 0x9A03, 0x9A04, 0x9A05, 
0x9A0B, 0x9A0D, 0x9A11, 0x9A16, 0x9A18, 0x9A1B, 0x9A2D, 0x9A35, 0x9A38, 0x9A3E, 
0x9A41, 0x9A42, 0x9A44, 0x9A4A, 0x9A4C, 0x9A4E, 0x9A4F, 0x9A52, 0x9A58, 0x9A64, 
0x9AAA, 0x9AB0, 0x9AB9, 0x9ABC, 0x9ABF, 0x9AC0, 0x9AC6, 0x9ACF, 0x9AD1, 0x9AD6, 
0x9AD7, 0x9ADF, 0x9AE1, 0x9AE3, 0x9AE6, 0x9AEB, 0x9AED, 0x9AF0, 0x9AF2, 0x9AF4, 
0x9AF9, 0x9AFA, 0x9AFB, 0x9AFD, 0x9B02, 0x9B05, 0x9B06, 0x9B0A, 0x9B0B, 0x9B0D, 
0x9B10, 0x9B12, 0x9B16, 0x9B18, 0x9B19, 0x9B1F, 0x9B22, 0x9B23, 0x9B28, 0x9B29, 
0x9B2E, 0x9B2F, 0x9B32, 0x9B3A, 0x9B48, 0x9B4B, 0x9B4D, 0x9B4E, 0x9B51, 0x9B58, 
0x9B66, 0x9B74, 0x9B80, 0x9B83, 0x9B92, 0x9B93, 0x9B97, 0x9BA7, 0x9BA8, 0x9BAA, 
0x9BAD, 0x9BB9, 0x9BC1, 0x9BC6, 0x9BCA, 0x9BD4, 0x9BDB, 0x9BE2, 0x9BF7, 0x9C08, 
0x9C0A, 0x9C0C, 0x9C13, 0x9C24, 0x9C2D, 0x9C2E, 0x9C2F, 0x9C31, 0x9C35, 0x9C39, 
0x9C3A, 0x9C3E, 0x9C4F, 0x9C52, 0x9C53, 0x9C60, 0x9C63, 0x9C67, 0x9C78, 0x9C7B, 
0x9CE6, 0x9D03, 0x9D06, 0x9D07, 0x9D08, 0x9D0C, 0x9D12, 0x9D15, 0x9D18, 0x9D19, 
0x9D1F, 0x9D23, 0x9D30, 0x9D36, 0x9D41, 0x9D42, 0x9D44, 0x9D53, 0x9D54, 0x9D5E, 
0x9D69, 0x9D6F, 0x9D70, 0x9D77, 0x9D7B, 0x9D7E, 0x9D84, 0x9D89, 0x9D96, 0x9D9A, 
0x9DA1, 0x9DA4, 0x9DAC, 0x9DB5, 0x9DB8, 0x9DB9, 0x9DBB, 0x9DBF, 0x9DC1, 0x9DC2, 
0x9DC7, 0x9DD3, 0x9DD6, 0x9DD9, 0x9DE6, 0x9DE9, 0x9DEA, 0x9DEB, 0x9DF0, 0x9DF1, 
0x9DF3, 0x9DFD, 0x9DFF, 0x9E07, 0x9E0F, 0x9E15, 0x9E1B, 0x9E1C, 0x9E77, 0x9E7B, 
0x9E80, 0x9E82, 0x9E84, 0x9E8B, 0x9E8C, 0x9E8F, 0x9E91, 0x9E9E, 0x9EA4, 0x9EA9, 
0x9EAA, 0x9EAF, 0x9EBD, 0x9EBF, 0x9EC5, 0x9ECC, 0x9ECF, 0x9ED0, 0x9ED6, 0x9EDA, 
0x9EDD, 0x9EE0, 0x9EE5, 0x9EEE, 0x9EEF, 0x9EF2, 0x9EF5, 0x9EF6, 0x9EF7, 0x9EFA, 
0x9EFB, 0x9EFC, 0x9EFD, 0x9EFF, 0x9F00, 0x9F02, 0x9F04, 0x9F09, 0x9F0A, 0x9F10, 
0x9F17, 0x9F19, 0x9F22, 0x9F2B, 0x9F2C, 0x9F2F, 0x9F34, 0x9F38, 0x9F39, 0x9F3E, 
0x9F54, 0x9F55, 0x9F57, 0x9F60, 0x9F66, 0x9F69, 0x9F6B, 0x9F72, 0x9F76, 0x9F8E, 
0x9F92, 0x9F94, 0x9F9D, 0x9FA0, 0x9FA2, 0x9FA5 };


UINT PASCAL
is_ksx1002(UINT code)
{
    static int table_size = sizeof(ksx1002_table) / sizeof(int);
    int min, max, mid;
    if (code > 0x9FA5 || code < 0x4E1F)
        return 0;
    /* binary search in table */
    min = 0;
    max = table_size;
    while (max >= min) {
        mid = (min + max) / 2;
        if (ksx1002_table[mid] < code)
            min = mid + 1;
        else if (ksx1002_table[mid] > code)
            max = mid - 1;
        else
            return 1;
    }
    return 0;
}

UINT PASCAL
hanja_idx(UINT code)
{
    UINT offset=0;

    UINT numUni=UNIHAN_UNI;
    UINT numExta=UNIHAN_EXTA;
    int tmp;

    tmp = numUni % IDX_COL;
    numUni += tmp ? (IDX_COL - tmp):0;
    tmp = numExta % IDX_COL;
    numExta += tmp ? (IDX_COL - tmp):0;

    if (code < 0x3400 || code >=0xfaff) return -1;
    if (code >=0xa000 && code <=0xf8ff) return -1;

    if (code >= 0xf900) {
    	offset= code - 0xf900;
	offset += numUni + numExta;
    } else if (code >= 0x4e00) {
    	offset= code - 0x4e00;
	offset += numExta;
    } else /* if (code >= 0x3400) */ {
    	offset= code - 0x3400;
    }

    tmp= offset / IDX_COL;
    offset*=2; /* 2-bytes */
    offset += tmp ? tmp*CRLF:0;
    return offset;
}

int GetHangulFromHanjaIndex(LPMYSTR lpRead, LPMYSTR lpBuf, DWORD dwBufLen, LPTSTR lpFilename)
{
    HANDLE hTblFile;
    PSECURITY_ATTRIBUTES psa;
    int nSize = 0;
    DWORD dwFileSize, dwRead;
    LPMYSTR lpDic;

    psa = CreateSecurityAttributes();

    hTblFile = CreateFile(lpFilename, 
                          GENERIC_READ,
                          FILE_SHARE_READ,
                          NULL, 
                          OPEN_EXISTING,
                          FILE_ATTRIBUTE_NORMAL, 
                          (HANDLE)NULL);

    if (hTblFile == INVALID_HANDLE_VALUE) {
        goto Err0;
    }

    if (dwBufLen >=1) 
    {
        MYCHAR szBuf[4];
        int hsz=0;
        UINT offset;

        lpDic=szBuf;

        if (!ReadFile(hTblFile, lpDic, 2, &dwRead, NULL))
            goto Err0;
        if (*lpDic != 0xfeff)
            goto Err1;// bom ?

        while (ReadFile(hTblFile, lpDic, 2, &dwRead, NULL)) {
            if (*lpDic != MYTEXT('#')) break; // read some header
            hsz+=dwRead;
            while (ReadFile(hTblFile, lpDic, 2, &dwRead, NULL)) {
                hsz+=dwRead;
                if (dwRead == 2 && *lpDic == MYTEXT('\n'))
                    break;
            }
        }
        SetFilePointer(hTblFile, -2, NULL, FILE_CURRENT);

        offset=hanja_idx(*lpRead);
        if (offset == -1) goto Err1;

        SetFilePointer(hTblFile, offset, NULL, FILE_CURRENT);
        if (ReadFile(hTblFile, lpDic, 2, &dwRead, NULL)) {
            *(LPWSTR)(((LPBYTE)lpDic) + 2) = MYTEXT('\0');
            MyDebugPrint((TEXT(" *** Hangul= %x\n"),*lpDic));
            *lpBuf=*lpDic;
            nSize=2;
        }
    }

Err1:
    CloseHandle(hTblFile);

Err0:
    FreeSecurityAttributes(psa);
    return nSize;
}

/*
 * ex: ts=8 sts=4 sw=4 et
 */
